<?xml version="1.0"?>
<dds xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:noNamespaceSchemaLocation="https://community.rti.com/schema/7.3.0/rti_routing_service.xsd">


  <!-- 
    Set up default config ENV variables after 6.1.14. 
    Override with either ENV variables i.e. "export VAR=X" or command line -DVAR=X 
    -->
  <configuration_variables>
    <value>

      <!-- 
        This will either be the Platform or C2 name depending on where this is being run 
        -->
      <element>
        <name>ROUTER_NAME</name>
        <value>VEHICLE_123</value>
      </element>

      <element>
        <name>PLATFORM_GUID</name>
        <value>ef32b88e6e0c49e99886ae20c28d7f3c</value>
      </element>

      <!-- ________________________ QOS Profiles____________________________ -->

      <!-- 
        Generally both "sides" i.e. Platform and C2 likely are using the same QoS 
        however there could be scenarios where they would be different(separate teams ownership).
        In that case, assign each side independently.
      -->
      <element>
        <name>PLATFORM_PARTICIPANT_QOS</name>
        <value>LAN::default_participant_qos</value>
      </element>

      <element>
        <name>PLATFORM_STATUS_QOS</name>
        <value>LAN::status_qos</value>
      </element>

      <element>
        <name>PLATFORM_STATUS_1SEC_QOS</name>
        <value>LAN::status_1sec_qos</value>
      </element>

      <element>
        <name>PLATFORM_STATUS_10SEC_QOS</name>
        <value>LAN::status_10sec_qos</value>
      </element>

      <element>
        <name>PLATFORM_STATUS_30SEC_QOS</name>
        <value>LAN::status_30sec_qos</value>
      </element>

      <element>
        <name>PLATFORM_STATUS_60SEC_QOS</name>
        <value>LAN::status_60sec_qos</value>
      </element>

      <element>
        <name>PLATFORM_COMMAND_QOS</name>
        <value>LAN::command_qos</value>
      </element>

      <element>
        <name>C2_PARTICIPANT_QOS</name>
        <value>LAN::default_participant_qos</value>
      </element>

      <element>
        <name>C2_COMMAND_QOS</name>
        <value>LAN::command_qos</value>
      </element>

      <element>
        <name>WAN_PARTICIPANT_QOS</name>
        <value>WAN::default_participant_qos</value>
      </element>

      <element>
        <name>WAN_STATUS_QOS</name>
        <value>WAN::status_qos</value>
      </element>

      <element>
        <name>WAN_COMMAND_QOS</name>
        <value>WAN::command_qos</value>
      </element>


      <!-- ________________________ Domain IDS _____________________________ -->
      <element>
        <name>CONTROL_DOMAIN</name>
        <value>100</value>
      </element>
      <element>
        <name>PLATFORM_DOMAIN</name>
        <value>0</value>
      </element>
      <element>
        <name>WAN_DOMAIN</name>
        <value>1</value>
      </element>
      <element>
        <name>C2_DOMAIN</name>
        <value>2</value>
      </element>

      <!-- ________________________ SWITCHES _______________________________ -->
      <!-- 
        This variable enables messaging Routes between Platforms
      -->
      <element>
        <name>P2P_ENABLE</name>
        <value>false</value>
      </element>

      <!-- 
        Enable distributed logging/monitoring. 
        Creates another Domain Participant in CONTROL_DOMAIN that publishes
        internal log/statistic data to view in Admin Console
      -->
      <element>
        <name>DEBUG_MODE</name>
        <value>false</value>
      </element>

      <!-- 
        Enables Remote Admin Service.
        REQUEST/REPLY endpoint to update Routing Service config at runtime.
      -->
      <element>
        <name>CONTROL_MODE</name>
        <value>false</value>
      </element>

      <!-- 
        ___________________________ TOPICS______________________________________
        Use to select Topics to move between C2/PLATFORM 
        NOTE: No spaces in the lists or they break silently
        -->

      <element>
        <!-- PLATFORM -> C2 Ensure Delivery (RELIABILITY QoS) -->
        <name>PLATFORM_COMMAND_TOPICS</name>
        <value>PlatformCommandAck</value>
        </element>

      <element>
        <!-- PLATFORM -> C2 FULL RATE -->
        <name>PLATFORM_STATUS_TOPICS</name>
        <value>NULL</value>
      </element>

      <element>
        <!-- 
          PLATFORM -> C2 Downsampled (SAMPLE every 1 SEC)
          -->
        <name>PLATFORM_STATUS_1SEC_TOPICS</name>
        <value>PlatformStatus</value>
      </element>

      <element>
        <!-- 
          PLATFORM -> C2 Downsampled (SAMPLE every 10 SECs)
          -->
        <name>PLATFORM_STATUS_10SEC_TOPICS</name>
        <value>NULL</value>
      </element>

      <element>
        <!-- 
          PLATFORM -> C2 Downsampled (SAMPLE every 30 SECs)
          -->
        <name>PLATFORM_STATUS_30SEC_TOPICS</name>
        <value>NULL</value>
      </element>

      <element>
        <!-- 
          PLATFORM -> C2 Downsampled (SAMPLE every 60 SECs)
          -->
        <name>PLATFORM_STATUS_60SEC_TOPICS</name>
        <value>NULL</value>
      </element>

      <!-- 
        C2 -> PLATFORM FILTERED by destination.parentID
        (Content Filter that will only allow messages to the matching parentID)
        -->
      <element>
        <name>C2_COMMAND_TOPICS</name>
        <value>C2Command</value>
      </element>

      <!-- PLATFORM -> PLATFORM -->
      <element>
        <name>PLATFORM_TO_PLATFORM_TOPICS</name>
        <value>NULL</value>
      </element>
    </value>

  </configuration_variables>


  <!--
  //////////////////////////////////////////////////////////////////////////////

                   DO NOT MODIFY BELOW THIS LINE. READ-ONLY. 
  ALL CONTROL SHOULD BE DONE THROUGH THE CONFIGURATION VARIABLES ABOVE/START SCRIPT

  //////////////////////////////////////////////////////////////////////////////
  -->


  <routing_service name="c2">

    <annotation>
      <documentation>
        This configuration defines message routing on the C2 side.

        Sessions are created where thread pools/prioritization can be assigned.
        They can also be enabled/disabled dynamically.

        Within that are auto topic routes that generate readers and writers
        based on the *TOPICS parameters.
      </documentation>
    </annotation>

    <!-- The administration tag enables remote administration, and is
            required when using Admin Console. -->
    <administration>
      <enabled>$(CONTROL_MODE)</enabled>
      <domain_id>$(CONTROL_DOMAIN)</domain_id>
      <distributed_logger>
        <enabled>$(DEBUG_MODE)</enabled>
        <filter_level>WARNING</filter_level>
      </distributed_logger>
      <datareader_qos base_name="REMOTE_ADMIN::remote_admin_replier_qos" />
      <datawriter_qos base_name="REMOTE_ADMIN::remote_admin_replier_qos" />
      <domain_participant_qos>
        <participant_name>
          <name>$(ROUTER_NAME) ADMIN</name>
        </participant_name>
      </domain_participant_qos>
    </administration>

    <!-- 
      This is the Monitoring configuration for all the entities in
      this routing service, and is required when using Admin Console. 
      -->
    <monitoring>
      <enabled>$(DEBUG_MODE)</enabled>
      <!-- The domain id where to publish the monitoring information -->
      <domain_id>$(CONTROL_DOMAIN)</domain_id>
      <!-- How often to publish it -->
      <status_publication_period>
        <sec>5</sec>
        <nanosec>0</nanosec>
      </status_publication_period>

      <!-- How often to compute statistics -->
      <statistics_sampling_period>
        <sec>1</sec>
        <nanosec>0</nanosec>
      </statistics_sampling_period>
      <domain_participant_qos>
        <participant_name>
          <name>$(ROUTER_NAME) MONITOR</name>
        </participant_name>
      </domain_participant_qos>
    </monitoring>


    <domain_route>

      <!-- Define Domain Participants for the C2 side -->
      <participant name="wan_participant">
        <domain_id>$(WAN_DOMAIN)</domain_id>
        <domain_participant_qos base_name="$(WAN_PARTICIPANT_QOS)">
          <participant_name>
            <name>$(ROUTER_NAME)-WAN</name>
          </participant_name>
        </domain_participant_qos>
      </participant>

      <participant name="c2_participant">
        <domain_id>$(C2_DOMAIN)</domain_id>
        <domain_participant_qos base_name="$(C2_PARTICIPANT_QOS)">
          <participant_name>
            <name>$(ROUTER_NAME)-C2</name>
          </participant_name>
        </domain_participant_qos>
      </participant>


      <session name="c2_to_wan_guid_cmd">

        <!-- C2 -> WAN Commands -->
        <auto_topic_route name="c2_command_filter">
          <publish_with_original_info>true</publish_with_original_info>
          <input participant="c2_participant">
            <allow_topic_name_filter>$(C2_COMMAND_TOPICS)</allow_topic_name_filter>
            <datareader_qos base_name="$(C2_COMMAND_QOS)" />
          </input>
          <output participant="wan_participant">
            <allow_topic_name_filter>$(C2_COMMAND_TOPICS)</allow_topic_name_filter>
            <datawriter_qos base_name="$(WAN_COMMAND_QOS)" />
          </output>
        </auto_topic_route>
      </session>

      <session name="wan_to_c2_status">

        <!-- WAN -> C2 Status -->
        <auto_topic_route name="platform_status_filter">
          <publish_with_original_info>true</publish_with_original_info>
          <input participant="wan_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_TOPICS)</allow_topic_name_filter>
            <datareader_qos base_name="$(WAN_STATUS_QOS)" />
          </input>
          <output participant="c2_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_TOPICS)</allow_topic_name_filter>
            <datawriter_qos base_name="$(PLATFORM_STATUS_QOS)" />
          </output>
        </auto_topic_route>

        <auto_topic_route name="platform_status_1sec_filter">
          <publish_with_original_info>true</publish_with_original_info>
          <input participant="wan_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_1SEC_TOPICS)</allow_topic_name_filter>
            <datareader_qos base_name="$(WAN_STATUS_QOS)" />
          </input>
          <output participant="c2_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_1SEC_TOPICS)</allow_topic_name_filter>
            <datawriter_qos base_name="$(PLATFORM_STATUS_QOS)" />
          </output>
        </auto_topic_route>

        <auto_topic_route name="platform_status_10sec_filter">
          <publish_with_original_info>true</publish_with_original_info>
          <input participant="wan_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_10SEC_TOPICS)</allow_topic_name_filter>
            <datareader_qos base_name="$(WAN_STATUS_QOS)" />
          </input>
          <output participant="c2_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_10SEC_TOPICS)</allow_topic_name_filter>
            <datawriter_qos base_name="$(PLATFORM_STATUS_QOS)" />
          </output>
        </auto_topic_route>

        <auto_topic_route name="platform_status_60sec_filter">
          <publish_with_original_info>true</publish_with_original_info>
          <input participant="wan_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_60SEC_TOPICS)</allow_topic_name_filter>
            <datareader_qos base_name="$(WAN_STATUS_QOS)" />
          </input>
          <output participant="c2_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_60SEC_TOPICS)</allow_topic_name_filter>
            <datawriter_qos base_name="$(PLATFORM_STATUS_QOS)" />
          </output>
        </auto_topic_route>

      </session>

      <session name="wan_to_c2_command_ack">

        <!-- WAN -> C2 Platform Command ACK -->
        <auto_topic_route name="platform_command_ack_filter">
          <publish_with_original_info>true</publish_with_original_info>
          <input participant="wan_participant">
            <allow_topic_name_filter>$(PLATFORM_COMMAND_TOPICS)</allow_topic_name_filter>
            <datareader_qos base_name="$(WAN_COMMAND_QOS)" />
          </input>
          <output participant="c2_participant">
            <allow_topic_name_filter>$(PLATFORM_COMMAND_TOPICS)</allow_topic_name_filter>
            <datawriter_qos base_name="$(PLATFORM_COMMAND_QOS)" />
          </output>
        </auto_topic_route>
      </session>

    </domain_route>
  </routing_service>


  <routing_service name="platform">

    <annotation>
      <documentation>
        This configuration defines message routing on the C2 side.

        Sessions are created where thread pools/prioritization can be assigned.
        They can also be enabled/disabled dynamically.

        Within that are auto topic routes that generate readers and writers 
        based on the *TOPICS parameters.
      </documentation>
    </annotation>

    <!-- The administration tag enables remote administration, and is
            required when using Admin Console. -->
    <administration>
      <enabled>$(CONTROL_MODE)</enabled>
      <domain_id>$(CONTROL_DOMAIN)</domain_id>
      <distributed_logger>
        <enabled>$(DEBUG_MODE)</enabled>
        <filter_level>WARNING</filter_level>
      </distributed_logger>
      <datareader_qos base_name="REMOTE_ADMIN::remote_admin_replier_qos" />
      <datawriter_qos base_name="REMOTE_ADMIN::remote_admin_replier_qos" />
      <domain_participant_qos>
        <participant_name>
          <name>$(ROUTER_NAME) ADMIN</name>
        </participant_name>
      </domain_participant_qos>
    </administration>

    <!-- 
      This is the Monitoring configuration for all the entities in
      this routing service, and is required when using Admin Console. 
      -->
    <monitoring>
      <enabled>$(DEBUG_MODE)</enabled>
      <!-- The domain id where to publish the monitoring information -->
      <domain_id>$(CONTROL_DOMAIN)</domain_id>
      <!-- How often to publish it -->
      <status_publication_period>
        <sec>5</sec>
        <nanosec>0</nanosec>
      </status_publication_period>

      <!-- How often to compute statistics -->
      <statistics_sampling_period>
        <sec>1</sec>
        <nanosec>0</nanosec>
      </statistics_sampling_period>
      <domain_participant_qos>
        <participant_name>
          <name>$(ROUTER_NAME) MONITOR</name>
        </participant_name>
      </domain_participant_qos>
    </monitoring>

    <domain_route>

      <!-- Define Domain Participants for the Platform side -->
      <participant name="platform_participant">
        <domain_id>$(PLATFORM_DOMAIN)</domain_id>
        <domain_participant_qos base_name="$(PLATFORM_PARTICIPANT_QOS)">
          <participant_name>
            <name>$(ROUTER_NAME) PLATFORM</name>
          </participant_name>
        </domain_participant_qos>
      </participant>

      <participant name="wan_participant">
        <domain_id>$(WAN_DOMAIN)</domain_id>
        <domain_participant_qos base_name="$(WAN_PARTICIPANT_QOS)">
          <participant_name>
            <name>$(ROUTER_NAME) WAN</name>
          </participant_name>
        </domain_participant_qos>
      </participant>


      <session name="platform_to_wan_status">

        <!-- PLATFORM -> WAN Status messages -->
        <auto_topic_route name="platform_status_route">
          <publish_with_original_info>true</publish_with_original_info>
          <input participant="platform_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_TOPICS)</allow_topic_name_filter>
            <datareader_qos base_name="$(PLATFORM_STATUS_QOS)" />
          </input>
          <output participant="wan_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_TOPICS)</allow_topic_name_filter>
            <datawriter_qos base_name="$(WAN_STATUS_QOS)" />
          </output>
        </auto_topic_route>

        <!-- PLATFORM -> WAN Status messages every 1 SEC-->
        <auto_topic_route name="platform_status_1sec_route">
          <publish_with_original_info>true</publish_with_original_info>
          <input participant="platform_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_1SEC_TOPICS)</allow_topic_name_filter>
            <datareader_qos base_name="$(PLATFORM_STATUS_1SEC_QOS)" />
          </input>
          <output participant="wan_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_1SEC_TOPICS)</allow_topic_name_filter>
            <datawriter_qos base_name="$(WAN_STATUS_QOS)" />
          </output>
        </auto_topic_route>


        <!-- PLATFORM -> WAN Status messages every 10 SEC-->
        <auto_topic_route name="platform_status_10sec_route">
          <publish_with_original_info>true</publish_with_original_info>
          <input participant="platform_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_10SEC_TOPICS)</allow_topic_name_filter>
            <datareader_qos base_name="$(PLATFORM_STATUS_10SEC_QOS)" />
          </input>
          <output participant="wan_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_10SEC_TOPICS)</allow_topic_name_filter>
            <datawriter_qos base_name="$(WAN_STATUS_QOS)" />
          </output>
        </auto_topic_route>

        <!-- PLATFORM -> WAN Status messages every 30 SEC-->
        <auto_topic_route name="platform_status_30sec_route">
          <publish_with_original_info>true</publish_with_original_info>
          <input participant="platform_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_30SEC_TOPICS)</allow_topic_name_filter>
            <datareader_qos base_name="$(PLATFORM_STATUS_30SEC_QOS)" />
          </input>
          <output participant="wan_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_30SEC_TOPICS)</allow_topic_name_filter>
            <datawriter_qos base_name="$(WAN_STATUS_QOS)" />
          </output>
        </auto_topic_route>


        <!-- PLATFORM -> WAN Status messages every 60 SEC-->
        <auto_topic_route name="platform_status_60sec_route">
          <publish_with_original_info>true</publish_with_original_info>
          <input participant="platform_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_60SEC_TOPICS)</allow_topic_name_filter>
            <datareader_qos base_name="$(PLATFORM_STATUS_60SEC_QOS)" />
          </input>
          <output participant="wan_participant">
            <allow_topic_name_filter>$(PLATFORM_STATUS_60SEC_TOPICS)</allow_topic_name_filter>
            <datawriter_qos base_name="$(WAN_STATUS_QOS)" />
          </output>
        </auto_topic_route>

      </session>


      <session name="platform_to_wan_command_ack">

        <!-- PLATFORM -> WAN Command Ack messages -->
        <auto_topic_route name="platform_command_ack_route">
          <publish_with_original_info>true</publish_with_original_info>
          <input participant="platform_participant">
            <allow_topic_name_filter>$(PLATFORM_COMMAND_TOPICS)</allow_topic_name_filter>
            <datareader_qos base_name="$(PLATFORM_COMMAND_QOS)" />
          </input>
          <output participant="wan_participant">
            <allow_topic_name_filter>$(PLATFORM_COMMAND_TOPICS)</allow_topic_name_filter>
            <datawriter_qos base_name="$(PLATFORM_COMMAND_QOS)" />
          </output>
        </auto_topic_route>

      </session>

      <session name="wan_to_platform_guid">

        <!-- WAN -> PLATFORM Commands if MATCH filter expression -->
        <auto_topic_route name="c2_command_guid_filter">
          <publish_with_original_info>true</publish_with_original_info>
          <input participant="wan_participant">
            <allow_topic_name_filter>$(C2_COMMAND_TOPICS)</allow_topic_name_filter>
            <datareader_qos base_name="$(WAN_COMMAND_QOS)" />

            <!-- Use a SQL style syntax to filter on message content -->
            <content_filter>
              <expression>msg.destination = &amp;hex($(PLATFORM_GUID))</expression>
            </content_filter>
          </input>
          <output participant="platform_participant">
            <allow_topic_name_filter>$(C2_COMMAND_TOPICS)</allow_topic_name_filter>
            <datawriter_qos base_name="$(PLATFORM_COMMAND_QOS)" />
          </output>
        </auto_topic_route>

      </session>

      <!-- This session moves messages between platforms -->
      <session name="platform_to_platform" enabled="$(P2P_ENABLE)">

        <!-- PLATFORM -> WAN P2P messages -->
        <auto_topic_route name="platform_to_wan">
          <publish_with_original_info>true</publish_with_original_info>
          <input participant="platform_participant">
            <allow_topic_name_filter>$(PLATFORM_TO_PLATFORM_TOPICS)</allow_topic_name_filter>
            <datareader_qos base_name="$(PLATFORM_STATUS_QOS)" />
          </input>
          <output participant="wan_participant">
            <allow_topic_name_filter>$(PLATFORM_TO_PLATFORM_TOPICS)</allow_topic_name_filter>
            <datawriter_qos base_name="$(WAN_STATUS_QOS)" />
          </output>
        </auto_topic_route>

        <!-- WAN -> PLATFORM P2P messages -->
        <auto_topic_route name="wan_to_platform">
          <publish_with_original_info>true</publish_with_original_info>
          <input participant="wan_participant">
            <allow_topic_name_filter>$(PLATFORM_TO_PLATFORM_TOPICS)</allow_topic_name_filter>
            <datareader_qos base_name="$(WAN_STATUS_QOS)" />
          </input>
          <output participant="platform_participant">
            <allow_topic_name_filter>$(PLATFORM_TO_PLATFORM_TOPICS)</allow_topic_name_filter>
            <datawriter_qos base_name="$(PLATFORM_STATUS_QOS)" />
          </output>
        </auto_topic_route>
      </session>

    </domain_route>
  </routing_service>
</dds>